---
tags:
  - linux
  - firewall
title: OpenGFW
description: It's time to give power to the people and democratize censorship.
draft: false
image: /blog-images/cat.jpg
date: 2025-10-18
---

ุชู ุงู ูพุณุช ุจุง ฺฉ ุงุจุฒุงุฑ ูุงุฑูุงู ุงุดูุง ูุดู. ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ุงุจุฒุงุฑ ูุชููุฏ ู ุชุดฺฉูุงุช ูู ุณุงูุณูุฑุดูพ ุญุฑูู ุง ุชู ุดุจฺฉู ุฎูุฏุชูู ุฑุงู ุจูุฏุงุฒุฏ. ููุธูุฑ ูู ุงุฒ ูุงุฑูุงู ฺุฒ ูุซู iptables ูุณุช. ุงูุง ุชูุงูุช ุนูุฏู ุงู ูุงุฑูุงู ุงู ูุณุช ฺฉู ูุงุจูุช ุจุฑุฑุณ ุนูู ุงูฺฏู ูุง ู ุจุณุชู ูุง ุดุจฺฉู ุฑู ุฏุฑ ูุงู ูุง ูุฎุชูู ุฑู ุฏุฑุงุฎุชุงุฑ ุดูุง ูุฑุงุฑ ูุฏู. ุดุจู ุจู ุชุดฺฉูุงุช ฺฉู ุฏุฑ ุฒุฑุณุงุฎุช ูู ฺฉุดูุฑ ูุง ูุซู ุงุฑุงูุ ุชุฑฺฉูุ ฺู ู ุฑูุณู ูุฌูุฏ ุฏุงุฑู. ุจุณุงุฑ ุงุฒ ุงุจุฒุงุฑูุง ุณุงูุณูุฑ ูุจูุงู ููุท ุจุฑุง ุงูุฑุงุฏ ุฎุงุต ุณุงุฒูุงูโูุง ุฏุฑ ุฏุณุชุฑุณ ุจูุฏ. ุณุงุฒูุฏูโูุง ุงู ูุงุฑูุงู ุฏูุณุช ุฏุงุฑู ฺฉู ูุฑ ฺฉุณ ุจุชููู ุจู ุงู ุงุจุฒุงุฑ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดู.

## OpenGFW

ูพุฑูฺู OpenGFW ุจู ููุธูุฑ ุฏููฺฉุฑุงุชุฒู ฺฉุฑุฏู ุณุงูุณูุฑุดูพ ุจุฑุง ุงูุฑุงุฏ ุนุงุฏ ุณุงุฎุชู ุดุฏู. ฺูุฏููุฑุฏ ุงุฒ ฺฉุงุฑุจุฑุฏ ูุง ฺฉู ุงู ูุฑู ุงูุฒุงุฑ ูุชููู ุฏุงุดุชู ุจุงุดู ุงููุง ูุณุช:

- ูุฑุงูุจุช ูุงูุฏู ุงุฒ ูุฑุฒูุฏุงู
- ูุณุฏูุฏ ุณุงุฒ ุชุจูุบุงุชโ ู ุจุฏุงูุฒุงุฑ
- ุฌููฺฏุฑ ุงุฒ ูุฑฺฏููู ุณูุงุณุชูุงุฏู ุฏุฑ ุดุจฺฉู ุฎุตูุต
- ฺฉูฺฉ ุจู ุงุฑุถุง ุงูฺฏุฒู ูุง ุฏฺฉุชุงุชูุฑ ุดูุง

ุฐุงุชู ุงู ูพุฑูฺู ููฺฉูู ุจุฑุง ุจุฑุฎ ุงุฒ ุงูุฑุงุฏ ุนุฌุจ ุจู ูุธุฑ ุจุงุฏ. ุงูุง ุจู ูุฑ ุญุงูุ ุงฺฏุฑ ุจู ูุณุงุฆู ูุซู ยซุญู ุฏุณุชุฑุณ ุจู ุงูุชุฑูุชยป ู ยซุงูุชุฑูุช ุงุฒุงุฏ ุจุฑุง ูููยป ุจุงูุฑ ุฏุงุฑุฏุ ูุฌูุฏ ููฺู ฺุฒ ุฎู ููุชููู ุนูู ุงู ููุถูุน ุจุงุดู. ฺู ุจุณุง ฺฉู ุจุชููุฏ ุจุง ุฏุฑฺฉ ุงู ูุณุงุฆู ฺฉูฺฉ ุจุฒุฑฺฏ ุจู ุงู ุฏุงุณุชุงู ุจฺฉูุฏ. ุงู ูู ุฐฺฉุฑ ฺฉูู ฺฉู ุณุงุฒูุฏฺฏุงู ุงู ูุงุฑูุงูุ ููุฒูุงู ุณุงุฒูุฏู ูพุฑูุชฺฉู VPN ูุฏุฑุชููุฏ Hysteria2 ูู ูุณุชูุฏ!

ู ุจุฑุนฺฉุณุ ุงฺฏุฑ ุจุงูุฑ ุฏุงุฑุฏ ฺฉู ูุตูุญุช ูุณุช ุงูุฑุงุฏ ุจู ุจุฑุฎ ุงุฒ ููุงุจุน ุงูุชุฑูุช ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏุ ูุชููุฏ ุณุงูุณูุฑ ุฑู ุญุช ุงุฒ ุงู ูู ฺฉู ูุณุช ุจุงูุงุชุฑ ุจฺฉุดุฏ ๐

## ฺุทูุฑ ฺฉุงุฑ ูฺฉููุ

ูุงุฑูุงู ูุง ุฑู ูุนูููุง ุฑู ฺฉุงููพูุชุฑ ูุง ุดุฎุต ุจุงูุง ููุงุฑู. ุงูุง ุจุฑุง ุชุณุช ู ุงุดูุง ุจุง ูุญูู ุฑุงู ุงูุฏุงุฒ ุงููุ ูุชููุฏ ุงูู ุฑู ุชู ฺฉุงููพูุชุฑ ุฎูุฏุชูู ูู ุชุณุช ฺฉูุฏ. ุจุง ุงู ฺฉุงุฑุ ุฏุฑุญุงูุช ุนุงุฏ ููุท ุฌุฑุงู ุดุจฺฉู ฺฉุงููพูุชุฑ ุฎูุฏุชูู ุชุญุช ุชุงุซุฑ ูุฑุงุฑ ูฺฏุฑู. ูุนูุง ุจุง ุงู ุฑูู ุฌูู ูุฑูโฆ

### ูุตุจ

ูุงุฑูุงู ูุฑู ุงูุฒุงุฑ ุจุง ุฒุจุงู Golang ููุดุชู ุดุฏู. ุจุฑุง ูุตุจ ฺฉุฑุฏู ุงูู ุฏู ุฑุงู ุฏุงุฑุฏ.

ฑ. ูพุฑูฺู ุฑู clone ฺฉูุฏ ู ุฎูุฏุชูู ุจุง ฺฏูููฺฏ Build ฺฉูุฏ:

```bash
export CGO_ENABLED=0
go build
```

ฒ. ูุงู ุจุงูุฑ ูุฑู ุงูุฒุงุฑ ุฑู [ูุณุชูู ุงุฒ ฺฏุช ูุงุจ](https://github.com/apernet/OpenGFW/releases) ูพุฑูฺู ุฏุงูููุฏ ฺฉูุฏ.

### ุฑุงู ุงูุฏุงุฒ ู ุงุฌุฑุง

ูุจู ุงุฒ ุงุฌุฑุง ูุฑู ุงูุฒุงุฑ ูุงุฒ ูุณุช ฺฉู ฺฉ ุณุฑ ูุงฺูู ูุง ฺฉุฑูู ูููฺฉุณ ุฑู ุฏุฑ ุณุณุชู ุนุงูู ุฎูุฏุชูู ูุตุจ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุฏุฑ ุงูุฌุง ูุณุช ูฺฉูู:

- kmod-nft-queue
- kmod-nf-conntrack-netlink

ุฎุจุฑ ุฎูุจ ุงู ูุณุช ฺฉู ุงฺฏุฑ ุงุฒ ุชูุฒุน ูุง ูุชุนุงุฑู ูุซู Fedora ู Ubuntu ุงุณุชูุงุฏู ูฺฉูุฏุ ุงู ูุงฺูู ูุง ุจู ุงุญุชูุงู ุฒุงุฏ ููุฑุงู ุจุง ุณุณุชู ุนุงูู ุดูุง ูุตุจ ุดุฏูุฏ. ูุตุจ ุฏุณุช ุงู ูุงฺูู ูุง ุจุดุชุฑ ุจุฑุง ุณุณุชู ุนุงูู ูุง ุฎุงุต ูุซู OpenWRT ููุถูุนุช ุฏุงุฑู. ( ุจู ุฏูุงู ูุฎุชููุ ฺฉู ุงุญุชูุงูุง ูุญุฏูุฏ ุจูุฏู ุณุฎุช ุงูุฒุงุฑ ุฑูุชุฑ ูุชููู ุฌุฒุด ุจุงุดู)

ุจุนุฏ ุงุฒ ฺฺฉ ฺฉุฑุฏู ุงู ููุถูุนุ ูุงู ูพฺฉุฑุจูุฏ ูุฑู ุงูุฒุงุฑ ุฑู ุจุง ูุงู โโโ`config.yamlโ` ุงุฌุงุฏ ูฺฉูู. ููููู ฺฉุงููฺฏ ฺฉู ูุงุฒู ุฏุงุฑุฏ ุฑู ูุฑุงุฑ ูุฏู:

```yaml
io:
  queueSize: 1024
  queueNum: 100 
  table: opengfw 
  connMarkAccept: 1001 
  connMarkDrop: 1002 
  rcvBuf: 4194304
  sndBuf: 4194304
  local: true 
  rst: false 

workers:
  count: 4 
  queueSize: 64
  tcpMaxBufferedPagesTotal: 65536
  tcpMaxBufferedPagesPerConn: 16
  tcpTimeout: 10m 
  udpMaxStreams: 4096
```

ุงู ูุงู ูพฺฉุฑุจูุฏ ฺฉ ุณุฑ ุงุฒ ูพุงุฑุงูุชุฑ ูุง ุฏุงุฎู ุจุฑูุงูู ุฑู ุชูุธู ูฺฉูู. ูพุงุฑุงฺฏุฑุงู ุงูู (ุจุฎุด io)ุ ูพฺฉุฑุจูุฏ ูุง ูุฑุชุจุท ุจุง ุชุนุงูู ูุงุฑูุงู ุฏุงุฎู ุณุณุชู ุนุงูู ุดูุง (ุนู nftables ุง iptables) ุฑู ูุดุฎุต ูฺฉูู ู ูพุงุฑุงฺฏุฑุงู ุฏูู (ุจุฎุด workers) ูุฑุจูุท ุจู cuncurrency ูุฑู ุงูุฒุงุฑ ูุดู. ุชูุถุญุงุช ูุฎุชุตุฑ ุฏุฑููุฑุฏ ุงู ููุฏ ูุง ุฏุฑ [ูุณุชูุฏุงุช ูพุฑูฺู](https://gfw.dev/docs/build-run/#config-example) ูุฌูุฏ ุฏุงุฑู ฺฉู ูุชููุฏ ูุทุงูุนู ฺฉูุฏ. ุงูุง ุงฺฏุฑ ุงุดูุง ูุณุช ูุชููุฏ ุงุฒ ููู ุญุงูุช ูุง ูพุด ูุฑุถ ุงุณุชูุงุฏู ฺฉูุฏ.

::info
ุจุง ุชูุฌู ุจู ูุนูุงุฑ ุณุณุชู ุนุงูู ูุง ูููฺฉุณุ OpenGFW ูุฑู ุงูุฒุงุฑ ูุณุช ฺฉู ุฏุฑ ุจุฎุด User space ฺฉุงููพูุชุฑ ุดูุง ูุนุงูุช ูฺฉูู. ุจุฑูุงูู ูุง ฺฉู ุฏุฑ User space ูุนุงูุช ูฺฉูู ููุชููู ูุนุงูุช ูุง ุงูฺูู ุฑู ุจุฏูู ุชุนุงูู ุจุง ฺฉุชุงุจุฎุงูู ูุง ูุฑุชุจุท ุจุง ฺฉุฑูู ุงูุฌุงู ุจุฏู. ูพุงุฑุงฺฏุฑุงู io ุงุฒ ูุงู ูพฺฉุฑุจูุฏ ูู ุฏููุง ูุฑุชุจุท ุจุง ููู ููุถูุน ูุณุช.
::

ุฏุฑ ุงูุฏู ุฏูุณุช ุฏุงุฑู ฺฉู ุจุชููู ุฏุฑููุฑุฏ ูุญูู ฺฉุงุฑ ุงู ูุฑู ุงูุฒุงุฑ ุงุฒ ูุญุงุธ ูู ูู ุจููุณู. ุงูุง ูุนูุง ุจุงุฏ ูุฑู ุงูุฒุงุฑ ุฑู ุฑุงู ุจูุฏุงุฒู!

ูุฑุณู ุจู ุจุฎุด ุฌุฐุงุจ: ุงุฌุงุฏ ูุงู ููุงูู `rules.yaml` ุจุฑุง ุชุนู ุณุงุณุช ูุฑู ุงูุฒุงุฑ ุฏุฑ ููุงุฌูู ุจุง ุจุณุชู ูุง ุดุจฺฉู!

ุชู ุงู ูุงู ุดูุง ูุฌููุนู ุง ุงุฒ ููุงูู ุฑู ุชุนุฑู ูฺฉูุฏ ฺฉู ุฏุฑ ููุงุฌู ุจุง ฺฉุงูฺฉุดู ูุง ูุฎุชูู ฺู ุนูู ุงูุฌุงู ุจุดู. ูุงู rules ุฑู ุจุงุฏ ุจุง ุณูุชฺฉุณ ุฒุจุงู [expr](https://github.com/expr-lang/expr) ุจููุณุฏ. ุงู ุฒุจุงู ุจู ุดูุง ฺฉูฺฉ ูฺฉูู ฺฉู ุชู ุชุนุฑู ููุงูู ุจุชููุฏ ุชุง ุฌุง ููฺฉู ุงูุนุทุงู ูพุฐุฑ ุนูู ฺฉูุฏ. ู ููููู ุงุฒ ุชฺฉูฺฉ ูุง ุณุงุฏู  ูุณุฏูุฏุณุงุฒุ ุชฺฉูฺฉ DNS poison ูุณุช. ุจุงุฏ ุจุฑุง ุดุฑูุน ุณุงุช ุนู ุจุงุจุง ุฑู ุฏุฑ ูุธุฑ ุจฺฏุฑู ู ุงูุฌุงูุด ุจุฏู:

```yaml
- name: I hate alibaba!
  action: modify
  modifier:
    name: dns
    args:
      a: "0.0.0.0"
      aaaa: "::"
  expr: dns != nil && dns.qr && any(dns.questions, {.name endsWith "alibaba.ir"})
```

ุฏุฑ ููุฏ nameุ ูุงู ูุงููู ุฑู ูุดุฎุต ูฺฉูุฏ. ููุฏ action ูุชููู ฺฉ ุงุฒ ููุฏุงุฑ ูุง allow, block, drop, modify ุฑู ุฏุฑุงูุช ฺฉูู.
ุฏุฑ ุชฺฉูฺฉ dns poision ูุนูููุง ุฏุฑ ููุงุฌูู ุจุง ุฏุชุงฺฏุฑุงู dns ุบุฑูุฌุงุฒุ ุงูู ุจุณุชู ุฏุณุชฺฉุงุฑ ูุดู ุชุง ุงุฒ ุฏุณุชุฑุณ ุจู ูพุงุณุฎ ุตุญุญ ุฌููฺฏุฑ ุจุดู. ูพุณ ูุง ุงูุฌุง ุงุฒ ุนูู modify ุงุณุชูุงุฏู ฺฉุฑุฏู ุชุง ุจุณุชู ุฏุณุชฺฉุงุฑ ุจุดู.

ุฏุฑ ููุฏ ุจุนุฏ ุนู modifierุ ูุดุฎุต ูฺฉูู ฺฉู ุจุณุชู dns ููุฑุฏ ูุธุฑ ุจู ฺู ููุฏุงุฑ ุชุบุฑ ฺฉูู. ููุฏุงุฑ ุงู ููุฏ ูุง ูุชููู ูุฑ ฺุฒ ุบุฑููุทู ุง ุจุงุดู. ูุซู ุงุฏุฑุณ ฺฉ ip ูุญู ุจู ุฌุง ip public.

ู ุฏุฑ ุงุฎุฑุ ุฏุฑ ููุฏ exprุ ุดุฑุท ููุฑุฏ ูุธุฑ ุฑู ุจุฑุง ูุทุงุจูุช ุฏุงุฏู ุจุง ุณุงุช ููุฑุฏ ูุธุฑ ุฎูุฏููู ูููุณู. ูุง ุงูุฌุง ุงู ูุญุฏูุฏุช ุฑู ุจุฑุง ุจุณุชู ูุง ฺฉูุฆุฑ dns ุจุง ูุงู โalibaba.irโ ุงุนูุงู ฺฉุฑุฏู. ุจุฑุง ุจุฑุฑุณ ููุฏ ูุง ููุฌูุฏ ุจู ูุณุชูุฏุงุช [OpenGFW](https://gfw.dev/docs/analyzers/) ูุฑุงุฌุนู ฺฉูุฏ.

ุญุงูุง ูุฑู ุงูุฒุงุฑ ุฑู ุจุง ุงุฑฺฏููุงู ูุง config.yaml ู rules.yaml ุงุฌุฑุง ูฺฉูู:

```bash
$ sudo ./OpenGFW-linux-amd64 -c config.yaml rules.yaml 
2025-10-18T21:25:53+03:30   INFO    engine started
```

ุงฺฏุฑ ุงุฑูุฑ ูุดุงูุฏู ูฺฉุฑุฏุฏุ ูุชููุฏ ฺฉุงุฑุง ูุฑู ุงูุฒุงุฑ ุฑู ุจุฑุฑุณ ฺฉูุฏ. ูู ุงูุฌุง ุงุฒ ุงุจุฒุงุฑ dig ุจุฑุง ูพุฏุง ฺฉุฑุฏู ุงูพ ุงุฏุฑุณ ุณุงุช alibaba.ir ุงุณุชูุงุฏู ูฺฉูู. ูุชุฌู ุจุงุฏ ฺุฒ ุดุจู ุจู ุฒุฑ ุจุงุดู:

```bash
$ dig alibaba.ir

; <<>> DiG 9.18.39 <<>> alibaba.ir
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 21880
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;alibaba.ir.            IN  A

;; ANSWER SECTION:
alibaba.ir.     0   IN  A   0.0.0.0

;; Query time: 674 msec
;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
;; WHEN: Sat Oct 18 21:38:21 +0330 2025
;; MSG SIZE  rcvd: 65
```

::info
ุจู ุฎุงุทุฑ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุฑูุด dns poison ุฏุฑุจุฑุงุจุฑ ูพุฑูุชฺฉู DNS Over HTTPS ฺฉุงุฑุง ูุฏุงุฑู. ุฏุฑ ููฺู ุดุฑุงุท ูุชููุฏ ุงุฒ ููุชุฑ ฺฉุฑุฏู ุจุฑ ุงุณุงุณ ููุฏ sni ุฏุฑ ุจุณุชู TLS ุงุณุชูุงุฏู ฺฉูุฏ.
::

ูุง ุตุฑูุง ุจุง ุงูุงูุฒูุฑ DNS ูุงุฑูุงู ฺฉุฑุฏู. ุจู ุนูุช ุนุฏู ุฑูุฒูฺฏุงุฑุ ูพุฑูุชฺฉู DNS ุฏุฑ ุญุงูุช ุณูุช ุงุด ุฑุงูฺฉุงุฑ ุนุงู ุจุฑุง ุณุงูุณูุฑ ูุณุช. ฺฉุงูฺฉุดูโูุง ุฑูุฒูฺฏุงุฑโุดุฏู ูุซู ูพุฑูุชฺฉู ูุง VPN ฺุทูุฑุ ุฎุจุฑ ุฌุฐุงุจ ุงูู ฺฉู ุงู ูุงุฑูุงู ุงุฒ [ุจุฑุฎ ุงุฒ ูพุฑูุชฺฉู ูุง VPN ุฑูุฒูฺฏุงุฑ ุดุฏู](https://gfw.dev/docs/analyzers/#fet-fully-encrypted-traffic) ูู ูพุดุชุจุงู ูฺฉูู!โ ูุชููุฏ ุงูุงูุฒูุฑ ูุง ูุฎุชูู ู ูุญูู ฺฉุงุฑ ุงูููุง ุฑู ุงุฒ ูุณุชูุฏุงุช ูพุฑูฺู ูุดุงูุฏู ฺฉูุฏ.

## ฺุทูุฑ ูุงุฑูุงู ุฑู ุฏุฑ ุดุจฺฉู ุฎูุฏู ูพุงุฏู ุณุงุฒ ฺฉููุ

ุชุง ุงูุงู ูุงุฑูุงู ุฑู ุฏุฑ ฺฉุงููพูุชุฑ ุดุฎุต ุชุณุช ฺฉุฑุฏู. ุงูุง ุจุฑุง ุงูฺฉู ุงู ุณุณุชู ฺฉุงุฑุจุฑุฏ ุชุฑ ุจุงุดูุ ุงุญุชูุงูุง ุฏูุณุช ุฏุงุฑุฏ ฺฉู ุงู ุฑู ุชู router ุดุจฺฉู ููุฑุฏ ูุธุฑุชูู ุฑุงู ุงูุฏุงุฒ ฺฉูุฏ. ุงู ูุงุฑูุงู ูุงุฒ ุจู ฺฉ ุฑูุชุฑ ุจุง ุณุณุชู ุนุงูู ูุจุชู ุจุฑ ูููฺฉุณ ุฏุงุฑู ฺฉู ุงุฒุงุฏ ุนูู ุฎูุจ ูู ุจู ุดูุง ุจุฏู. ฺฏุฒูู ูุนุฑูู ุจุฑุง ุงู ฺฉุงุฑุ ุณุณุชู ุนุงูู OpenWRT ูุณุช. ุจุฑุฎ ุงุฒ ุฑูุชุฑ ูุง ุจุงุฒุงุฑ ุงู ุณุณุชู ุนุงูู ุฑู ุจุฑุง ูุตุจ ูพุดุชุจุงู ูฺฉูู. ูู ุฏุณุชุฑุณ ุจู ุฑูุชุฑ ููุงุณุจ ุงูฺฉุงุฑ ูุฏุงุฑู.

ุงูุง ุฎูุดุจุฎุชุงูู ุณุณุชู ุนุงูู OpenWRT ุฑู ุงุจุฒุงุฑ ูุง ูุฌุงุฒ ุณุงุฒ ูุซู qemu ูุงุจู ุงุฌุฑุง ูุณุช. ุจู ุนุจุงุฑุชู ุฏฺฏูุ OpenWRT ุชูุฑุจุง ุฑู ูุฑ ฺฉุงููพูุชุฑ ุงุนู ุงุฒ ฺฉุงููพูุชุฑ ูุง ุดุฎุต ูุงุจู ูุตุจ ูุณุช. ุฏุฑ ุงุฏุงูู ุงุฒ ูพูุชูุฑู QEMU ุจุฑุง ุดุจู ุณุงุฒ ูุตุจ ุงู ูุงุฑูุงู ุฑู OpenWRT ุงุณุชูุงุฏู ูฺฉููโฆ

ุฏุฑ ูุฏู ุงูู ุจุงุฏ ูุฌููุนู ุงุจุฒุงุฑ ูุง ูุฑุชุจุท ุจุง QEMU ุฑู ุฏุฑ ฺฉุงููพูุชุฑ ุฎูุฏุชูู ูุตุจ ฺฉูุฏ:

```bash
sudo apt-get install qemu
```

ุจุนุฏุ image ุณุณุชู ุนุงูู OpenWRT ุฑู ุงุฒ [ุณุงุช ูุฑุฌุน](https://downloads.openwrt.org/) ุฏุงูููุฏ ฺฉูุฏ. ูพุดููุงุฏ ูู ูุฑฺู 23.05 ูุณุช. ุฏุฑ ูุฑฺู ุฌุฏุฏ ุชุฑ ุนู 24.10ุ ูุงฺูู ูุง ฺฉุฑููู ูุงุฒู ุจุฑุง ฺฉุงุฑ ุงู ูุฑู ุงูุฒุงุฑ ูุฌูุฏ ูุฏุงุฑู. (ุง ุญุฏุงููุ ูู ูพุฏุง ูฺฉุฑุฏู)

ุจุนุฏ ุงุฒ ุงูุชุฎุงุจ ูุฑฺู ููุฑุฏ ูุธุฑุ ุงุฒ ุฏุงุฑฺฉุชูุฑ Targets/x86/64 ูุชููุฏ image ูุง ููุฌูุฏ ุฑู ูุดุงูุฏู ฺฉูุฏ. ูู ุงุฒ image ููุน generic-ext4-combined ุงุณุชูุงุฏู ูฺฉูู. ุงูุฌ ุฑู ุฏุงูููุฏ ฺฉูุฏ ู ุจุง ุฏุณุชูุฑ gunzip ุงูู ุฑู ุงุฒ ุญุงูุช ูุดุฑุฏู ุฎุงุฑุฌ ฺฉูุฏ.

ุญุงูุง ุจุงุฏ ุจุง ฺฉูฺฉ qemuุ ุงูุฌ ุฑู ุงุฌุฑุง ฺฉูุฏ. ฺูู ุงูพุดู ูุง ู ุงุฑฺฏููุงู ูุง qemu ฺฉู ุทููุงููุ ุจูุชุฑู ุงูู ุฑู ุฏุงุฎู ู ุดู ุงุณฺฉุฑูพุช ูุฑุงุฑ ุจุฏุฏ:

```bash
#!/usr/bin/bash
qemu-system-x86_64 \
  -M q35 \
  -drive file=openwrt-23.05.6-x86-64-generic-ext4-combined.img,format=raw,if=virtio \
  -m 512 \
  -nographic -enable-kvm \
  -device virtio-net,netdev=lan0 \
  -netdev user,id=lan0 \
  -device virtio-net,netdev=wan0 \
  -netdev user,id=wan0,hostfwd=tcp::11122-:22,hostfwd=tcp::8085-:80
```

ุชู ุงุณฺฉุฑูพุช ุจุงูุงุ ุจุนุฏ ุงุฒ ฺฉ ุณุฑ ุงูพุดู ูุง ฺฉู ูุซู ุชุนู ููุน ูุงุดู ู ููุฏุงุฑ ูููุฑุ ฺฉุงุฑุช ูุง ุดุจฺฉู ูุฌุงุฒ ูุงุดู ุฑู ูุดุฎุต ูฺฉูู. ุงุณุชูุงุฏู ุงุฒ netdev user ุฏุฑ ูพูุฑุช wan ูุงุดูุ ุงูฺฉุงู ุฏุณุชุฑุณ ุจู ุงูุชุฑูุช ุฑู ุจู OpenWRT ูุฏู. (ุฏุฑูุงูุน ุฏุณุชุฑุณ ุจู ุงูุชุฑูุช ุงุฒ ุทุฑู ฺฉุงููพูุชุฑ ูุงุณุช ุชุงูู ูุดู)

ุญุงูุง ุงุณฺฉุฑูพุช ุฑู ุงุฌุฑุง ฺฉูุฏ ู ููุชุธุฑ ุจุงุดุฏ ุชุง ุณุณุชู ุนุงูู ุจูุช ุจุดู. ุจุนุฏุ ุฏุณุชุฑุณ ุจู ุงูุชุฑูุช ูุงุดู ุฑู ฺฺฉ ฺฉูุฏ:

```bash
BusyBox v1.36.1 (2025-08-14 18:27:40 UTC) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 OpenWrt 23.05.6, r24232-539228933c
 -----------------------------------------------------
=== WARNING! =====================================
There is no root password defined on this device!
Use the "passwd" command to set up a new password
in order to prevent unauthorized SSH logins.
--------------------------------------------------
root@OpenWrt:/# ping 1.1.1.1
PING 1.1.1.1 (1.1.1.1): 56 data bytes
64 bytes from 1.1.1.1: seq=0 ttl=255 time=77.994 ms
64 bytes from 1.1.1.1: seq=1 ttl=255 time=78.461 ms
64 bytes from 1.1.1.1: seq=2 ttl=255 time=78.280 ms
64 bytes from 1.1.1.1: seq=3 ttl=255 time=78.034 ms
```

(ุงฺฏุฑ ุฏุณุชฺฏุงู ุจู ุงูุชุฑูุช ุฏุณุชุฑุณ ูุฏุงุดุชุ ุจุง ุฏุณุชูุฑ ip ุฏุฑ OpenWRTุ ูพฺฉุฑุจูุฏ ุดุจฺฉู ูุงุดู ุฑู ฺฺฉ ฺฉูุฏ. ุงุญุชูุงูุง gateway ุงููู ฺุฒู ฺฉู ูุฎูุงุฏ ฺฺฉ ฺฉูุฏ)

ููุช ุงุฒ ุงุชุตุงู ุงูุชุฑูุช ูุทูุนู ุดุฏุฏุ ูพุด ูุงุฒ ูุง ููุฑุฏ ูุงุฒ ุฑู ุงุฒ ูพฺฉุฌ ููุฌุฑ ูุฎุตูุต OpenWRT ูุตุจ ฺฉูุฏ:

```bash
opkg install nftables kmod-nft-queue kmod-nf-conntrack-netlink
```

ุนุงูู! ุญุงูุง ูุงู ุจุงูุฑ ุฑู OpenGFW ุฑู ุจู ูุญู ุจู ุฏุณุชฺฏุงู ููุชูู ฺฉูุฏ (ุจุง wget ูุชููุฏ ุงู ฺฉุงุฑ ุฑู ุงูุฌุงู ุจุฏุฏ ฺฉู ุจู ุทูุฑ ูพุดูุฑุถ ุฏุฑ ุณุณุชู ุนุงูู ููุฌูุฏู) ู ุจุนุฏ ุงุฒ ุงููุ ุฏููุง ูุซู ุจุฎุด ูุง ูุจูุ ูุงู rule.yaml ู config.yaml ุฑู ุงูุงุฏู ฺฉูุฏ ู ุจุฑูุงูู ุฑู ุงุฌุฑุง ฺฉูุฏ:

```bash
root@OpenWrt:~/gfw# ll
drwxr-xr-x    2 root     root          4096 Oct 10 11:55 ./
drwxr-xr-x    3 root     root          4096 Oct 10 11:44 ../
-rw-r--r--    1 root     root           562 Oct 10 11:45 config.yaml
-rwx------    1 root     root      13627544 Oct 10 11:54 opengfw*
-rw-r--r--    1 root     root           198 Oct 10 13:48 rule.yaml
root@OpenWrt:~/gfw# ./opengfw -c config.yaml rule.yaml 
2025-10-18T18:22:08Z    INFO    engine started
```

ุงฺฏุฑ ุจุง ุงุฑูุฑ ููุงุฌู ูุดุฏุฏุ ุนููฺฉุฑุฏ ูุงุฑูุงู ุฑู ูุชููุฏ ุจุง ฺุฒ ูุซู curl ุง dig (ุชู ุฎูุฏ ุฑูุชุฑ) ฺฺฉ ฺฉูุฏ. ุจุง ุนููฺฉุฑุฏ ุตุญุญ ูุงุฑูุงู ูุชููุฏ ูุชุฌู ุจฺฏุฑุฏ ฺฉู ุฏุณุชฺฏุงู ูุง ฺฉู ุจู ุงู ุฑูุชุฑ ูุชุตู ูุดู ูู ุงุฒ ููุชุฑ ููุฑุฏ ูุธุฑ ุดูุง ุฑุฏ ูุดู.

ุงุฏุงูู ุงู ุฏุงุณุชุงู ุจุง ุดูุงุณุช.
